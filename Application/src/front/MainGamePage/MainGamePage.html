<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <link rel="stylesheet" href="front/MainGamePage/style.css">
    <link href='https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css' rel='stylesheet'>
</head>
<body>
<header>
    <nav class="navbar">
        <a href="/home" class="nav-logo">
            <h2 class="logo-text">SuperHeroes</h2>
        </a>
    </nav>
</header>
<main>
    <div class="content">
        <h1 class="difficulty">Difficulty</h1>

        <div class="game-content">
            <div class="game">
                <h2 class="game-difficulty">Easy</h2>
                <button id="easyButton" class="play-button">Play</button>
            </div>
            <div class="game">
                <h2 class="game-difficulty">Normal</h2>
                <button id="normalButton" class="play-button">Play</button>
            </div>
            <div class="game">
                <h2 class="game-difficulty">Hard</h2>
                <button id="hardButton" class="play-button">Play</button>
            </div>
        </div>
    </div>
</main>
<script>
console.log("1");
document.addEventListener("DOMContentLoaded", () => {
    const token = localStorage.getItem("token");
    if (!token) {
        window.location.href = 'front/NotAuthorizedPage/NotAuthorized.html'
        return;
    }

    console.log("2");

    function sendGameRequest(difficulty) {
        fetch("http://localhost:8082/api/game/start.php", {
            method: "POST",
            headers: {
                "Content-Type": "application/json",
                "Authorization": `Bearer ${token}`
            },
            body: JSON.stringify({ difficulty: difficulty })
        })
            .then(response => response.json().then(data => ({ status: response.status, body: data })))
            .then(({ status, body }) => {
                if (status === 200) {
                    console.log("Game started:", body);
                    window.location.href = `front/GamePage/GamePage.html?game_id=${body.game_id}`;
                } else {
                    alert(body.message || "Eroare necunoscută.");
                }
            })
            .catch(err => {
                console.error("Eroare:", err);
                alert("A apărut o eroare la trimiterea cererii.");
            });
    }
    document.getElementById("easyButton").addEventListener("click", function(e) {
        e.preventDefault();
        console.log("e");
        sendGameRequest("easy");
    });

    document.getElementById("normalButton").addEventListener("click", function(e) {
        e.preventDefault();
        console.log("m");
        sendGameRequest("medium");
    });

    document.getElementById("hardButton").addEventListener("click", function(e) {
        e.preventDefault();
        console.log("h");
        sendGameRequest("hard");
    });
});</script>
</body>
</html>